/*
 * Copyright (C) 2012-2017 DataStax Inc.
 *
 * This software can be used solely with DataStax Enterprise. Please consult the license at
 * http://www.datastax.com/terms/datastax-dse-driver-license-terms
 */
package com.datastax.driver.dse.graph;

import org.testng.annotations.Test;

import static org.assertj.core.api.Assertions.assertThat;

public class PrintElementsTest {

    @Test(groups = "unit")
    public void should_print_graph_elements_with_graphson2_correctly() {
        GraphNode gn = GraphJsonUtils.readStringAsTreeGraphson20("{\"@type\":\"g:Vertex\",\"@value\":{\"id\":{\"~label\":\"person\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":2}},\"label\":\"person\",\"properties\":{\"name\":[{\"@type\":\"g:VertexProperty\",\"@value\":{\"id\":{\"~label\":\"name\",\"~out_vertex\":{\"~label\":\"person\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":2}},\"~local_id\":{\"@type\":\"g:UUID\",\"@value\":\"00000000-0000-7fff-0000-000000000000\"}},\"value\":\"marko\",\"label\":\"name\"}}],\"age\":[{\"@type\":\"g:VertexProperty\",\"@value\":{\"id\":{\"~label\":\"age\",\"~out_vertex\":{\"~label\":\"person\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":2}},\"~local_id\":{\"@type\":\"g:UUID\",\"@value\":\"00000000-0000-8000-0000-000000000000\"}},\"value\":{\"@type\":\"g:Int32\",\"@value\":29},\"label\":\"age\"}}]}}}");
        assertThat(gn.asVertex().toString()).isEqualTo("DefaultElement{id={~label=person, community_id=516547968, member_id=2}, label='person', properties={name=[DefaultVertexProperty{id={~label=name, ~out_vertex={~label=person, community_id=516547968, member_id=2}, ~local_id=00000000-0000-7fff-0000-000000000000}, properties=null, name=name, value=marko, parent-id={~label=person, community_id=516547968, member_id=2}}], age=[DefaultVertexProperty{id={~label=age, ~out_vertex={~label=person, community_id=516547968, member_id=2}, ~local_id=00000000-0000-8000-0000-000000000000}, properties=null, name=age, value=29, parent-id={~label=person, community_id=516547968, member_id=2}}]}}");
        assertThat(gn.asVertex().getProperty("name").toString()).isEqualTo("DefaultVertexProperty{id={~label=name, ~out_vertex={~label=person, community_id=516547968, member_id=2}, ~local_id=00000000-0000-7fff-0000-000000000000}, properties=null, name=name, value=marko, parent-id={~label=person, community_id=516547968, member_id=2}}");

        gn = GraphJsonUtils.readStringAsTreeGraphson20("{\"@type\":\"g:Edge\",\"@value\":{\"id\":{\"~label\":\"created\",\"~out_vertex\":{\"~label\":\"person\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":2}},\"~in_vertex\":{\"~label\":\"software\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":1}},\"~local_id\":{\"@type\":\"g:UUID\",\"@value\":\"fd48d261-1a0b-11e7-81ab-170a77df6dc0\"}},\"label\":\"created\",\"inVLabel\":\"software\",\"outVLabel\":\"person\",\"inV\":{\"~label\":\"software\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":1}},\"outV\":{\"~label\":\"person\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":2}},\"properties\":{\"weight\":{\"@type\":\"g:Property\",\"@value\":{\"key\":\"weight\",\"value\":{\"@type\":\"g:Float\",\"@value\":0.4}}}}}}");
        assertThat(gn.asEdge().toString()).isEqualTo("DefaultEdge{id={~label=created, ~out_vertex={~label=person, community_id=516547968, member_id=2}, ~in_vertex={~label=software, community_id=516547968, member_id=1}, ~local_id=fd48d261-1a0b-11e7-81ab-170a77df6dc0}, label='created', properties={weight=[DefaultProperty{name='weight', value=0.4, parent-id={~label=created, ~out_vertex={~label=person, community_id=516547968, member_id=2}, ~in_vertex={~label=software, community_id=516547968, member_id=1}, ~local_id=fd48d261-1a0b-11e7-81ab-170a77df6dc0}}]}, inV={~label=software, community_id=516547968, member_id=1}, inVLabel='software', outV={~label=person, community_id=516547968, member_id=2}, outVLabel='person'}");
        assertThat(gn.asEdge().getProperty("weight").toString()).isEqualTo("DefaultProperty{name='weight', value=0.4, parent-id={~label=created, ~out_vertex={~label=person, community_id=516547968, member_id=2}, ~in_vertex={~label=software, community_id=516547968, member_id=1}, ~local_id=fd48d261-1a0b-11e7-81ab-170a77df6dc0}}");

        gn = GraphJsonUtils.readStringAsTreeGraphson20("{\"@type\":\"g:Path\",\"@value\":{\"labels\":[[\"a\"],[\"b\"]],\"objects\":[{\"@type\":\"g:Vertex\",\"@value\":{\"id\":{\"~label\":\"person\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":2}},\"label\":\"person\",\"properties\":{\"name\":[{\"@type\":\"g:VertexProperty\",\"@value\":{\"id\":{\"~label\":\"name\",\"~out_vertex\":{\"~label\":\"person\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":2}},\"~local_id\":{\"@type\":\"g:UUID\",\"@value\":\"00000000-0000-7fff-0000-000000000000\"}},\"value\":\"marko\",\"label\":\"name\"}}],\"age\":[{\"@type\":\"g:VertexProperty\",\"@value\":{\"id\":{\"~label\":\"age\",\"~out_vertex\":{\"~label\":\"person\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":2}},\"~local_id\":{\"@type\":\"g:UUID\",\"@value\":\"00000000-0000-8000-0000-000000000000\"}},\"value\":{\"@type\":\"g:Int32\",\"@value\":29},\"label\":\"age\"}}]}}},{\"@type\":\"g:Edge\",\"@value\":{\"id\":{\"~label\":\"created\",\"~out_vertex\":{\"~label\":\"person\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":2}},\"~in_vertex\":{\"~label\":\"software\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":1}},\"~local_id\":{\"@type\":\"g:UUID\",\"@value\":\"fd48d261-1a0b-11e7-81ab-170a77df6dc0\"}},\"label\":\"created\",\"inVLabel\":\"software\",\"outVLabel\":\"person\",\"inV\":{\"~label\":\"software\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":1}},\"outV\":{\"~label\":\"person\",\"community_id\":{\"@type\":\"g:Int32\",\"@value\":516547968},\"member_id\":{\"@type\":\"g:Int64\",\"@value\":2}},\"properties\":{\"weight\":{\"@type\":\"g:Property\",\"@value\":{\"key\":\"weight\",\"value\":{\"@type\":\"g:Float\",\"@value\":0.4}}}}}}]}}");
        assertThat(gn.asPath().toString()).isEqualTo("DefaultPath{labels=[[a], [b]], objects=[DefaultElement{id={~label=person, community_id=516547968, member_id=2}, label='person', properties={name=[DefaultVertexProperty{id={~label=name, ~out_vertex={~label=person, community_id=516547968, member_id=2}, ~local_id=00000000-0000-7fff-0000-000000000000}, properties=null, name=name, value=marko, parent-id={~label=person, community_id=516547968, member_id=2}}], age=[DefaultVertexProperty{id={~label=age, ~out_vertex={~label=person, community_id=516547968, member_id=2}, ~local_id=00000000-0000-8000-0000-000000000000}, properties=null, name=age, value=29, parent-id={~label=person, community_id=516547968, member_id=2}}]}}, DefaultEdge{id={~label=created, ~out_vertex={~label=person, community_id=516547968, member_id=2}, ~in_vertex={~label=software, community_id=516547968, member_id=1}, ~local_id=fd48d261-1a0b-11e7-81ab-170a77df6dc0}, label='created', properties={weight=[DefaultProperty{name='weight', value=0.4, parent-id={~label=created, ~out_vertex={~label=person, community_id=516547968, member_id=2}, ~in_vertex={~label=software, community_id=516547968, member_id=1}, ~local_id=fd48d261-1a0b-11e7-81ab-170a77df6dc0}}]}, inV={~label=software, community_id=516547968, member_id=1}, inVLabel='software', outV={~label=person, community_id=516547968, member_id=2}, outVLabel='person'}]}");
    }
}
